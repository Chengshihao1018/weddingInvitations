<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <title>程世豪&唐聪 的婚礼邀请函</title>
  <link rel="stylesheet" href="./public/css/zepto.fullpage.css">
  <link rel="stylesheet" href="./public/css/animate.css">
  <link rel="stylesheet" href="./public/css/index.css">
  <style type="text/css">
    body {
      font-size: 1.2rem;
    }

    #loading-mask {
      width: 100%;
      height: 100%;
      position: absolute;
      left: 0;
      top: 0;
      background-color: #e2ecf5;
      z-index: 99;
    }

    .loading-box {
      position: absolute;
      top: 50%;
      left: 50%;
      margin-left: -150px;
      margin-top: -150px;
      display: block;
      width: 300px;
      height: 300px;
      border-radius: 3px;
      font-size: 30px;
      color: rgba(64, 158, 255, .5);
      text-align: center;
    }

    .loading-box p {
      font-size: 16px;
      margin: 16px 0;
    }

    .loading:before,
    .loading:after,
    .loading {
      display: inline-block;
      width: 1em;
      height: 1em;
      color: inherit;
      vertical-align: middle;
      pointer-events: none;
      border-radius: 50%;
      -webkit-animation-fill-mode: both;
      animation-fill-mode: both;
      -webkit-animation: loading 1.8s infinite ease-in-out;
      animation: loading 1.8s infinite ease-in-out;
    }

    .loading {
      color: currentcolor;
      position: relative;
      -webkit-transform: translateZ(0);
      transform: translateZ(0);
      -webkit-animation-delay: -0.16s;
      animation-delay: -0.16s;
      top: -1em;
    }

    .loading:before {
      right: 100%;
      -webkit-animation-delay: -0.32s;
      animation-delay: -0.32s;
    }

    .loading:after {
      left: 100%;
    }

    .loading:before,
    .loading:after {
      content: '';
      display: block;
      position: absolute;
      top: 0;
      width: inherit;
      height: inherit;
    }

    @-webkit-keyframes loading {

      0%,
      80%,
      100% {
        box-shadow: 0 1em 0 -1em;
      }

      40% {
        box-shadow: 0 1em 0 -.2em;
      }
    }

    @keyframes loading {

      0%,
      80%,
      100% {
        box-shadow: 0 1em 0 -1em;
      }

      40% {
        box-shadow: 0 1em 0 -.2em;
      }
    }

    .load-img {
      visibility: hidden;
    }
  </style>
  <script type="text/javascript">
    var loadSum = 0
    var isMobile = null

    function loadDone() {
      loadSum++
    }

    function pcTip() {
      if ((navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i))) {
        console.log('mobile')
        isMobile = true
      } else {
        console.log('pc')
        loadSum = loadSum - 10
        isMobile = false
        document.getElementById('loading-txt').innerHTML = '请使用手机或其它移动设备打开!'
      }
    }
  </script>
</head>

<body>
  <div id="loading-mask">
    <div class="loading-box">
      <div class="loading"></div>
      <p id="loading-txt">加载中</p>
    </div>
  </div>
  <div id="play-btn"><i class="iconfont" style="font-size: 20px;">&#xe617;</i></div>
  <img class="load-img" onload="loadDone();pcTip()" src="./public/photo/1.jpg">
  <img class="load-img" onload="loadDone()" src="./public/photo/2.jpg">
  <img class="load-img" onload="loadDone()" src="./public/photo/3.jpg">
  <img class="load-img" onload="loadDone()" src="./public/photo/4.jpg">
  <img class="load-img" onload="loadDone()" src="./public/photo/5.jpg">
  <img class="load-img" onload="loadDone()" src="./public/photo/6.jpg">
  <img class="load-img" onload="loadDone()" src="./public/photo/7.jpg">
  <img class="load-img" onload="loadDone()" src="./public/photo/8.jpg">
  <img class="load-img" onload="loadDone()" src="./public/photo/9.jpg">
  <img class="load-img" onload="loadDone()" src="./public/photo/10.jpg">
  <img class="load-img" onload="loadDone()" src="./public/photo/11.jpg">
  <img class="load-img" onload="loadDone()" src="./public/photo/12.jpg">
  <img class="load-img" onload="loadDone()" src="./public/photo/13.jpg">
  <img class="load-img" onload="loadDone()" src="./public/photo/14.jpg">
  <img class="load-img" onload="loadDone()" src="./public/photo/15.jpg">
  <img class="load-img" onload="loadDone()" src="./public/photo/16.jpg">
  <img class="load-img" onload="loadDone()" src="./public/photo/17.jpg">
  <img class="load-img" onload="loadDone()" src="./public/photo/18.jpg">
  <img class="load-img" onload="loadDone()" src="./public/photo/19.jpg">
  <div class="wp">
    <div class="wp-inner" style="max-width: 820px; overflow: hidden;; margin: 0 auto">
      <div class="page page0">
        <div class="photo-wrap">
          <div class="full-bg" style="height: 50%; position: relative;" data-sec="zoomCycle" data-time="0">
            <img src="./public/photo/1.jpg" style="height: 100%; width: 100%; object-fit: cover;
                    position: absolute;
                    left: 50%;
                    top: 0;
                    transform: translate(-50%,0);">
          </div>
          <p
            style="text-align:right; margin-right: 13rem;
                    font-family: Lucida Calligraphy, cursive, serif, sans-serif;color: rgba(55, 47, 47, 0.292); font-size: 1.3rem;">
            程先生 &
            唐小姐</p>
          <div class="full-bg" style="background-image: url(./public/photo/2.jpg); width: 9rem;height: 9rem;background-size: 100%;background-repeat:no-repeat;    border-radius: 8px;
                    position: absolute;
                    top: 50%;
                    right: 3rem;
                    transform: translate(0, -50%);" data-sec="zoomCycle" data-time="0">
          </div>
          <div class="full-bg" style="height: 50%; margin-top: 4rem;" data-sec="zoomCycle" data-time="0">
            <p style="text-align: center; color: rgba(0,0,0, .35); font-weight: 550;">今日所邀
              皆是生命中 不同阶段
              重要的你们</p>
            <div style="display: flex; margin-top: 2rem;">
              <h1 style="flex:1; text-align: center; margin: 0; padding: 0 .5rem;">今天</h1>
              <div class="full-bg"
                style="background-image: url(./public/photo/9.jpg); width: 12rem;height: 12rem;background-size: 100%;background-repeat:no-repeat;"
                data-sec="zoomCycle" data-time="0"></div>
              <p style="flex: 2; padding: 0 0.8rem; line-height: 2.5rem; margin: 0;">是的，我们结婚啦！这是一份心意满满的邀请函，请查收～
              </p>
            </div>
          </div>
        </div>
      </div>
      <div class="page page1">
        <div class="photo-wrap">
          <div class="full-bg js-animate animated animation-1000"
            style="background-image: url(./public/photo/3.jpg);width: 100%;height: 100%;" data-animate="myzoomIn">
          </div>
          <div class="text-frame js-animate animated" data-animate="rotateIn" data-time="500">

          </div>
          <div class="text-frame js-animate animated" data-animate="rotateIn" data-time="1200" data-sec="pulseing"
            data-sectime="1200">
          </div>
        </div>
        <div class="ele-wrap">
          <div style="display: flex;flex-direction: column; align-items: center; justify-content: center;height: 84%; width: 100%;   position: absolute;
          top: 50%;
          left: 0;
          transform: translate(0, -50%);">
            <div class="js-animate animated animation-500" data-animate="zoomIn" data-time="2000">
              <p style="text-align: center; color: rgba(3, 2, 2, 0.624);">
                "见证爱情最美好的样子，且铭记一生"
                <br>
                我们想
                <br>
                这便是婚礼最好的意义
              </p>
            </div>
            <div style="flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            max-height: 60%;
        ">
              <div class="full-bg js-animate animated animation-1000" style="
                max-width: 75%;
                flex: 1;
                overflow: hidden;
                max-height: 695px;
                background-color: rgba(255, 255, 255, .5);
                border-radius: 0.25;
                " data-animate="myzoomIn" data-time="3000">
                <img src="./public/photo/19.jpg" style="
                    height: 100%;
                    width: 100%;
                    transform: scale(0.9);
                    object-fit: cover;
                ">
              </div>
              <div class="js-animate animated animation-2000" data-animate="zoomIn" data-time="3000"
                style="width: 100%;text-align: center; margin-top: 58px;">
                <img src="./public/meta/invitation.png" style="max-width: 75%;">
              </div>
            </div>
            <div class="js-animate animated animation-500" data-animate="zoomIn" data-time="2000">
              <p style="text-align: center; color: rgba(3, 2, 2, 0.624);line-height: 2rem;">
                【时间】2022/10/29 11:38
                <br />
                【席设】青山区玺合婚礼宴会中心152号
                <br />
                （江尚礼堂)
                <br />
                【新郎】程世豪 & 【新娘】唐聪
                <br />
                期待您携家人见证我们的婚礼
              </p>
            </div>
          </div>
        </div>
      </div>
      <div class="page page6">
        <img src="./public/photo/11.jpg" style="
          height: 100%; 
          width: 100%; 
          object-fit: cover;
          position: absolute;
          left: 50%;
          top: 0;
          transform: translate(-50%,0);">
        <div style="
          position: absolute;
          background-color: rgba(255, 255, 255, 0.8);
          height: 30%;
          width: 80%;
          left: 50%;
          bottom: 10%;
          transform: translate(-50%, 0);
          padding: 1.2rem;
          display: flex;
          align-items: center;
          justify-content: center;   
          border-radius: .4rem; 
          padding: 1rem;      
        ">
          <div style="width: 100%; height: 100%; border: 1px solid #7e3e03; color:#974f0b; border-radius: .4rem; display: flex; font-weight: 500;">
            <div style="
              flex: 1;
              height: 100%; 
              display: flex;
              align-items: center;
              justify-content: center;
              font-size: 2.3rem;
              "
              >婚<br>礼<br>流<br>程</div>
            <div style="
            flex: 2;
            height: 100%; 
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            ">
              <p class="hunliLiucheng-p">08：00 - 迎接新娘</p>
              <p class="hunliLiucheng-p">10：00 - 宾客签到</p>
              <p class="hunliLiucheng-p">11：00 - 婚礼仪式</p>
              <p class="hunliLiucheng-p">12：00 - 婚宴进餐</p>
            </div>
          </div>
        </div>
      </div>
      <div class="page page7">
        <img src="./public/photo/17.jpg" style="
          height: 100%; 
          width: 100%; 
          object-fit: cover;
          position: absolute;
          left: 50%;
          top: 0;
          transform: translate(-50%,0);">
        <div style="
          position: absolute;
          background-color: rgba(255, 255, 255, 0.6);
          height: 50%;
          width: 75%;
          left: 50%;
          top: 60%;
          transform: translate(-50%, -50%);
          padding: 1.2rem;
          display: flex;
          flex-direction: column;
        ">
          <div id="map"></div>
          <div id="location-btn"><i class="iconfont" style="font-size: 2rem;">&#xe616;</i></div>
          <div id="map-msg">
            <p class="js-animate animated" data-animate="bounceInDown" data-time="0"><i
                class="iconfont red-icon">&#xe63e;</i>青山区玺合婚礼宴会中心152号</p>
            <p class="js-animate animated" data-animate="bounceInLeft" data-time="100"><i
                class="iconfont red-icon">&#xe622;</i>临江大道青山江滩公园2期</p>
            <p class="js-animate animated" data-animate="bounceInRight" data-time="200"><i
                class="iconfont red-icon">&#xe72b;</i>江尚礼堂</p>
            <p class="js-animate animated" data-animate="bounceInUp" data-time="300"><i
                class="iconfont red-icon">&#xe636;</i>有任何疑问请致电 新郎&新娘</p>
          </div>
        </div>
      </div>
    </div>
  </div>
  <span class="start"><i class="iconfont" style="color: #fff;font-size: 2rem;">&#xe606;</i></span>
  <audio id="mp3" src="./public/music/music.mp3" autoplay loop></audio>
  <script src="./public/js/js.fullpage.js"></script>
  <script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=S6EO9oPso0n8aTMvfH1g0aLUX6vGZx1l"></script>
  <script>
    // 滚屏动画控制

    if (isMobile !== false) {
      var loadTimer = setInterval(() => {
        console.log(loadSum)
        if (loadSum >= 17) {
          start()
        }
      }, 300);
    }

    var domLists = []
    var mapFlag = false

    function start() {
      clearInterval(loadTimer);

      var forEach = [].forEach;

      setTimeout(() => {
        document.getElementById('loading-mask').style.display = 'none'
      }, 100);
      document.getElementsByClassName('wp-inner')[0].fullpage({
        change: function (e) {
          clearTime()
          // 移除动画属性
          forEach.call(document.querySelectorAll('.page')[e.cur].querySelectorAll('.js-animate'), function (v) {
            v.classList.add('hide');
            v.classList.remove(v.dataset['animate']);
            if (v.dataset['sec']) {
              v.classList.remove(v.dataset['sec']);
            }
          });
        },
        afterChange: function (e) {
          if (e.cur === 1 && !mapFlag) {
            initMap()
          }

          domLists = document.querySelectorAll('.page')[e.cur].querySelectorAll('.js-animate')
          forEach.call(domLists, v => {
            var time = v.dataset.time;
            v.timer = setTimeout(function () {
              v.classList.add(v.dataset['animate']);
              v.classList.remove('hide');
              if (v.dataset['sec']) {
                var time = v.dataset.sectime || 0
                v.sectimer = setTimeout(function () {
                  v.classList.remove(v.dataset['animate']);
                  v.classList.add(v.dataset['sec']);
                }, time);
              }
            }, time);
          })
        }
      });
    }

    function clearTime() {
      domLists.forEach((dom, i, arr) => {
        if (dom.timer) {
          clearTimeout(dom.timer);
        }
        if (dom.sectimer) {
          clearTimeout(dom.sectimer);
        }
        if (arr && arr.splice) {
          arr.splice(i, 1)
        }
      })
    }

    // 地图
    function initMap() {
      if (window.BMap) {
        mapFlag = true
        var mapCenter = [114.382753, 30.644135]
        var map = new BMap.Map("map", { minZoom: 10, maxZoom: 14 })

        map.centerAndZoom(new BMap.Point(mapCenter[0], mapCenter[1]), 13);

        function ComplexCustomOverlay(point, text, mouseoverText) {
          this._point = point;
          this._text = text;
          this._overText = mouseoverText;
        }
        ComplexCustomOverlay.prototype = new BMap.Overlay();
        ComplexCustomOverlay.prototype.initialize = function (map) {
          this._map = map;
          var div = this._div = document.createElement("div");
          div.style.position = "absolute";
          div.style.zIndex = BMap.Overlay.getZIndex(this._point.lat);
          div.style.backgroundColor = "#E60000";
          div.style.borderRadius = "3px";
          div.style.color = "white";
          div.style.height = "18px";
          div.style.padding = "2px 4px";
          div.style.lineHeight = "18px";
          div.style.whiteSpace = "nowrap";
          div.style.MozUserSelect = "none";
          div.style.fontSize = "12px"
          var span = this._span = document.createElement("span");
          div.appendChild(span);
          span.appendChild(document.createTextNode(this._text));
          var that = this;

          var arrow = this._arrow = document.createElement("div");
          // arrow.style.background = "url(http://map.baidu.com/fwmap/upload/r/map/fwmap/static/house/images/label.png) no-repeat";
          arrow.style.position = "absolute";
          arrow.style.width = "0";
          arrow.style.height = "0";
          arrow.style.top = "22px";
          arrow.style.left = "10px";
          arrow.style.overflow = "hidden";
          arrow.style.border = "6px solid transparent";
          arrow.style.borderTop = "6px solid #E60000";
          div.appendChild(arrow);

          map.getPanes().labelPane.appendChild(div);

          return div;
        }
        ComplexCustomOverlay.prototype.draw = function () {
          var map = this._map;
          var pixel = map.pointToOverlayPixel(this._point);
          this._div.style.left = pixel.x - parseInt(this._arrow.style.left) + "px";
          this._div.style.top = pixel.y - 30 + "px";
        }

        var myCompOverlay = new ComplexCustomOverlay(new BMap.Point(mapCenter[0], mapCenter[1]), "婚礼", "N and Y");

        map.addOverlay(myCompOverlay);

        document.querySelector('#location-btn').addEventListener('click', () => {
          map.panTo(new BMap.Point(mapCenter[0], mapCenter[1]))
        })
      }
    }

    // 音乐播放控制
    window.onload = function () {
      let mp3 = document.querySelector('#mp3')
      let playBtn = document.querySelector('#play-btn')
      let play

      mp3.load()

      document.addEventListener("WeixinJSBridgeReady", function () {
        mp3.play()
        if (!mp3.paused) {
          this.style.animationPlayState = 'running'
          mp3.play()
          play = true
        }
      }, false)

      play = !mp3.paused && mp3.readyState === 4

      if (play) {
        playBtn.style.animationPlayState = 'running'
      } else {
        playBtn.style.animationPlayState = 'paused'
      }

      playBtn.addEventListener('click', function (event) {
        if (play) {
          this.style.animationPlayState = 'paused'
          mp3.pause()
          play = false
        } else {
          if (mp3.readyState === 4) {
            this.style.animationPlayState = 'running'
            mp3.play()
            play = true
          }
        }
      })
    }
  </script>
</body>

</html>